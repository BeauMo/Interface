<!DOCTYPE html>
<html>

<head>
    <script src="jquery-3.6.0.slim.min.js"></script>
    <link rel="stylesheet" href="stylesheet.css">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1,0" />
    <title>Menu</title>

</head>

<body>

    <div class="tablet">
        <div class="content_tablet menu-page">
            <div id="main">
                <div class="left_side">
                    <div class="navbar">
                        <a href="welcome.html" class="pfeil_zurueck">Startseite</a>
                        <p style="font-weight: bold;">MENU</p>
                        <p>Tisch 3</p>
                    </div>

                    <div class="tab">
                        <button class="tablinks tab-getränke" onclick="openTabs(event, 'Getränke')" id="defaultOpen">Getränke</button>
                        <button class="tablinks tab-gerichte" onclick="openTabs(event, 'Gerichte')">Gerichte</button>
                    </div>

                    <div id="Getränke" class="tabcontent tabcontent-getränke">

                        <div id="drinks" class="accordion-div">
                            <!-- Div für Getränkeliste -->
                        </div>
                    </div>

                    <div id="Gerichte" class="tabcontent tabcontent-gerichte">
                        <div id="filter-buttons">
                            <button class="filter-button">Vegetarisch</button>
                            <button class="filter-button">Vorspeisen</button>
                            <button class="filter-button">Hauptgerichte</button>
                            <button class="filter-button">Kindermenüs</button>
                            <button class="filter-button">Desserts</button>
                        </div>

                        <div id="dishes" class="accordion-div">
                            <!-- Div für Essensliste -->
                        </div>
                    </div>
                </div>

                <div id="overviewOrder" class="right_side">
                    <div>
                        <h2>Übersicht</h2>
                        <h4>Ihre hinzugefügten Speisen und Getränke:</h4>
                        <div id="contentBasket"></div>
                        <button onclick="confirmOrder()">Bestellen</button>
                        <h4>Abgeschlossene Bestellungen</h4>
                        <div id="ordered"></div>

                    </div>

                </div>

            </div>

        </div>

        <div class="background_image wrapper">


        </div>

    </div>
</body>

</html>

<script>
    /*Script*/
    /*==================================================================
    ====================================================================*/

    function setup() {

        document.getElementById("contentBasket").innerHTML = sessionStorage.getItem("basket");
        let persistentOrders = document.getElementsByClassName("removeOrder");

        Array.prototype.forEach.call(persistentOrders, function(element) {
            element.addEventListener("click", removeFromPrepareOrder);
        });

        drinks.forEach(element => {
            var accordion = document.createElement("button");
            accordion.className = "accordion";

            var accordion_headline = document.createElement('p');
            accordion_headline.innerHTML = element.dish;
            accordion_headline.className = "accordion_headline";
            accordion.appendChild(accordion_headline);

            var price = document.createElement('p');
            price.innerHTML = element.price + " €";
            accordion.appendChild(price);
            // orderButton.addEventListener("click", addToOrder);



            var orderButton_div = document.createElement("div");
            orderButton_div.className = "orderbutton_left";

            var orderButton = document.createElement("button");
            orderButton.addEventListener("click", addToOrder);
            orderButton.innerHTML = "+";
            orderButton.className = "order_button"
            orderButton_div.appendChild(orderButton);

            var div = document.createElement('div');
            div.className = "panel";

            var dish = "<p class= 'meal_name'>" + element.dish + "</p>";
            var description = "<p class= 'ingredients'>" + element.description + "</p>";


            var p_description_left = document.createElement('div');
            p_description_left.className = "panel_content_left";
            //p_description_left.innerHTML = description;

            var p_description_right = document.createElement('div');
            p_description_right.className = "panel_content_right";
            p_description_right.innerHTML = dish + description;


            var img = document.createElement('img');
            img.className = "panel_content_img";
            img.src = element.picture;


            //div.appendChild(p_dish);
            div.appendChild(p_description_right);
            div.appendChild(p_description_left);
            p_description_left.appendChild(img);
            // accordion.appendChild(orderButton);

            $(orderButton).data("entry", element);

            document.getElementById("drinks").appendChild(orderButton_div);
            document.getElementById("drinks").appendChild(accordion);
            document.getElementById("drinks").appendChild(div);
        });

        dishes.forEach(element => {
            var accordion = document.createElement("button");
            accordion.className = "accordion";

            var accordion_headline = document.createElement('p');
            accordion_headline.innerHTML = element.dish;
            accordion_headline.className = "accordion_headline";
            accordion.appendChild(accordion_headline);

            var price = document.createElement('p');
            price.innerHTML = element.price + " €";
            accordion.appendChild(price);
            // orderButton.addEventListener("click", addToOrder);

            var orderButton_div = document.createElement("div");
            orderButton_div.className = "orderbutton_left";

            var orderButton = document.createElement("button");
            orderButton.addEventListener("click", addToOrder);
            orderButton.innerHTML = "+";
            orderButton.className = "order_button"
            orderButton_div.appendChild(orderButton);

            var div = document.createElement('div');
            div.className = "panel";

            var dish = "<p class= 'meal_name'>" + element.dish + "</p>";
            var description = "<p class= 'ingredients'>" + element.description + "</p>";


            var p_description_left = document.createElement('div');
            p_description_left.className = "panel_content_left";
            //p_description_left.innerHTML = description;

            var p_description_right = document.createElement('div');
            p_description_right.className = "panel_content_right";
            p_description_right.innerHTML = dish + description;


            var img = document.createElement('img');
            img.className = "panel_content_img";
            img.src = element.picture;


            //div.appendChild(p_dish);
            div.appendChild(p_description_right);
            div.appendChild(p_description_left);
            p_description_left.appendChild(img);

            $(orderButton).data("entry", element);

            document.getElementById("dishes").appendChild(orderButton_div);
            document.getElementById("dishes").appendChild(accordion);
            document.getElementById("dishes").appendChild(div);
        });

        buildAccordion();
    }

    function openTabs(evt, tabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tabcontent");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablinks");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        evt.currentTarget.className += " active";
    }
    /*Erster Tab beim Laden offen*/
    document.getElementById("defaultOpen").click();

    /*Produkt zum Warenkorb hinzufügen*/
    function addToOrder() {
        let addedOrder = $(this).data("entry")

        var div = document.createElement("div");
        div.className = "singleOrder";
        div.textContent = addedOrder.dish;
        div.setAttribute("price", addedOrder.price);

        var deleteButton = document.createElement("button");
        deleteButton.className = "removeOrder";
        deleteButton.textContent = "-";
        deleteButton.addEventListener("click", removeFromPrepareOrder);
        div.append(deleteButton);

        document.getElementById("contentBasket").appendChild(div);
    }

    function removeFromPrepareOrder() {
        $(this).parent().remove();
    }


    /*Accordion*/

    function buildAccordion() {
        var acc = document.getElementsByClassName("accordion");
        var i;

        for (i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function() {
                this.classList.toggle("active");
                var panel = this.nextElementSibling;
                if (panel.style.maxHeight) {
                    panel.style.maxHeight = null;
                } else {
                    panel.style.maxHeight = panel.scrollHeight + "px";
                }
            });
        }
    }

    function saveOrder() {
        sessionStorage.setItem("basket", document.getElementById("contentBasket").innerHTML);
    }

    function confirmOrder(){
        let contentBasket = document.getElementById("contentBasket");
    }

    /*Arrays in dem die Getränke und Gerichte angelegt werden*/
    let drinks = [{
            dish: "Cola groß",
            description: "Kohlensäurehaltiges Erfrischungsgetränk",
            ingredients: "Wasser, Zucker oder kalorienfreie Süßstoffe, Koffein, Aromen, Mineralstoffe und Zusatzstoffe",
            size: [0.3, 0.5],
            vegetarian: true,
            vegan: false,
            price: 4.3,
            picture: "\\Bildmaterial\\Getraenke\\Cola.png"
        }, {
            dish: "Cola klein",
            description: "lorem",
            size: [0.3, 0.5],
            vegetarian: true,
            vegan: false,
            price: 3.3,
            picture: "\\Bildmaterial\\Getraenke\\Cola.png"
        }, {
            dish: "Eistee groß",
            description: "lorem",
            size: [0.3, 0.5],
            vegetarian: true,
            vegan: false,
            price: 4.3,
            picture: "\\Bildmaterial\\Getraenke\\Eistee.png"
        }, {
            dish: "Eistee klein",
            description: "lorem",
            size: [0.3, 0.5],
            vegetarian: true,
            vegan: false,
            price: 3.3,
            picture: "\\Bildmaterial\\Getraenke\\Eistee.png"
        }, {
            dish: "Hausgemachte Limonade groß",
            description: "lorem",
            size: [0.3, 0.5],
            vegetarian: true,
            vegan: false,
            price: 4.3,
            picture: "\\Bildmaterial\\Getraenke\\limo.png"
        }, {
            dish: "Hausgemachte Limonade klein",
            description: "lorem",
            size: [0.3, 0.5],
            vegetarian: true,
            vegan: false,
            price: 3.3,
            picture: "\\Bildmaterial\\Getraenke\\limo.png"
        }, {
            dish: "Café groß",
            description: "lorem",
            size: [0.3, 0.5],
            vegetarian: true,
            vegan: false,
            price: 2.7,
            picture: "\\Bildmaterial\\Getraenke\\coffee.png"
        }, {
            dish: "Café klein",
            description: "lorem",
            size: [0.3, 0.5],
            vegetarian: true,
            vegan: false,
            price: 2.2,
            picture: "\\Bildmaterial\\Getraenke\\coffee.png"
        },






    ];

    let dishes = [{
            id: 5,
            dish: "Schnitzel mit Pommes",
            price: 12.00
        }, {
            id: 6,
            dish: "Rumpsteak mit Bratkartoffeln",
            price: 17.00
        }, {
            id: 7,
            dish: "Flammkuchen",
            price: 8.00
        }, {
            id: 8,
            dish: "Suppe",
            price: 6.00
        }, {
            id: 9,
            dish: "Salat",
            price: 4.50
        }, {
            id: 10,
            dish: "Apfelstrudel",
            price: 5.50
        },

    ];

    window.addEventListener("load", setup);
    window.addEventListener("beforeunload", saveOrder)
</script>